Set-ExecutionPolicy RemoteSigned -Scope CurrentUser -Force
# List of weak cipher identifiers to disable
$WeakCipherIdentifiers = @("3DES", "RC4", "DES", "MD5")
# Disable weak cipher suites
foreach ($WeakCipher in $WeakCipherIdentifiers) {
    $CipherSuites = Get-TlsCipherSuite | Where-Object { $_.Name -like "*$WeakCipher*" }
    foreach ($CipherSuite in $CipherSuites) {
        try {
            Disable-TlsCipherSuite -Name $CipherSuite.Name
            Write-Output "Disabled $($CipherSuite.Name)"
        } catch {
            Write-Output "Failed to disable $($CipherSuite.Name): $_"
        }
    }
}
# Enable strong cipher suites with highest priority
$StrongCipherSuites = @(
    "TLS_AES_256_GCM_SHA384",
    "TLS_AES_128_GCM_SHA256",
    "TLS_CHACHA20_POLY1305_SHA256",
    "TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384",
    "TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384",
    "TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256",
    "TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256"
)
foreach ($StrongCipher in $StrongCipherSuites) {
    try {
        Enable-TlsCipherSuite -Name $StrongCipher -Position 0
        Write-Output "Enabled $StrongCipher with high priority"
    } catch {
        Write-Output "Failed to enable ${StrongCipher}: $_"
    }
}
Write-Output "Complete - Weak ciphers disabled, strong ciphers enabled."
